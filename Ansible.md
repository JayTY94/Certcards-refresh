
Mental Model Summary
Inventory = who
Play = where and what category
Task = exact action
Module = state logic
......................................
Next notecard set (recommended):
Inventory patterns, grouping strategies, and variable precedence — the source of most production bugs.
Provide your feedback on BizChatYou said: yes, write that next setCopilot said: CopilotHere’s the next notecard set, covering inventory patterns, grouping strategies, and variable precedence — exactly where most real‑world Ansible failures originate.
......................................
Inventory Purpose
Inventory defines which hosts exist and how they are logically grouped for targeting.
......................................
Inventory Is Not Configuration
Inventory should describe topology, not behavior or execution logic.
......................................
INI Inventory Format
The INI format is the simplest inventory format and is commonly used for static host lists.
......................................
YAML Inventory Format
YAML inventory supports nested groups and is preferred for complex hierarchies.
......................................
Static Inventory
A static inventory is a fixed list of hosts defined in files.
......................................
Dynamic Inventory
A dynamic inventory generates hosts at runtime from an external source (cloud, CMDB, API).
......................................
Host Definition
A host is identified by a name or IP address and may include host-specific variables.
......................................
Host Variables
Host variables apply only to a single host and override group-level variables.
......................................
Group
A group is a logical collection of hosts used for targeting plays and applying variables.
......................................
Group Variables
Group variables apply to all hosts in the group unless overridden by higher-precedence values.
......................................
Group Hierarchy
Groups can contain other groups, allowing hierarchical targeting.
......................................
Parent Group
A parent group applies variables and targeting to all child groups.
......................................
Child Group
A child group inherits variables from its parent group unless overridden.
......................................
Common Grouping Strategy
Group hosts by function (web, db) rather than environment-specific behavior.
......................................
Anti-Pattern: Environment Logic in Tasks
Embedding environment logic inside tasks increases complexity and reduces reuse.
......................................
Better Pattern: Environment Groups
Use inventory groups like prod, stage, dev to scope variables cleanly.
......................................
all Group
The all group implicitly contains every host in the inventory.
......................................
ungrouped Group
The ungrouped group contains hosts not explicitly assigned to any group.
......................................
Inventory Variables vs Play Variables
Inventory variables are resolved before play execution; play variables override them.
......................................
Variable Precedence
Variable precedence determines which value is used when the same variable is defined multiple times.
......................................
High-Level Precedence Rule
More explicit definitions override more general ones.
......................................
Lowest Precedence
Role defaults have the lowest variable precedence.
......................................
Group Vars Precedence
Group variables override role defaults but are overridden by host variables.
......................................
Host Vars Precedence
Host variables override group variables.
......................................
Play Vars Precedence
Play variables override inventory variables.
......................................
Extra Vars Precedence
Extra vars (-e) always win and override all other variable definitions.
......................................
Why Extra Vars Are Dangerous
Extra vars can silently override expected values and hide configuration errors.
......................................
Precedence Debugging Smell
If behavior changes only when using -e, the variable model is probably broken.
......................................
Variable Collision
Variable collision occurs when the same variable name is reused unintentionally.
......................................
Variable Naming Strategy
Prefix variables by role or domain to avoid collisions (e.g., nginx_port).
......................................
Inventory as Source of Truth
Inventory should reflect real-world topology, not transient execution details.
......................................
Operational Rule of Thumb
If you can’t explain where a variable’s value comes from, the design is wrong.
......................................
Mental Model Summary
Inventory = topology
Groups = scope
Variables = data
Precedence = conflict resolution
......................................
Common Production Failure Mode
Unexpected behavior caused by variable precedence, not task logic.